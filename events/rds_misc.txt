namespace = rds_misc

#ARMY_CLONE
event = {
	id = rds_misc.1
	hide_window = yes
	trigger = {
		From = {
			army_type = reality_distortion_system_army
		}
	}
	is_triggered_only = yes
	immediate = {
		From = {
			save_event_target_as = death_army
		}
		FromFromFrom = {
			while = {
				count = 2
				create_army = {
					name = random
					owner = event_target:death_army.owner
					type = reality_distortion_system_army
				}
			}
		}
	}
}

#PLANET_DESTROYER
event = {
	id = rds_misc.2
	hide_window = yes
	trigger = {
		This = {
			any_fleet_in_orbit = {
				has_fleet_flag = planet_destroyer
				any_owned_ship = {
					AND = {
						EQUIPPED_WITH_RDS = yes
					}
				}
			}
		}
	}
	is_triggered_only = yes
	immediate = {
		This = {
			add_planet_devastation = 100
		}
	}
}

#LEADER_KILLER
event = {
	id = rds_misc.4
	hide_window = yes
	trigger = {
		From = {
			has_trait = leader_trait_death
		}
	}
	is_triggered_only = yes
	immediate = {
		From = {
			kill_leader = {
				show_notification = yes
			}
		}
	}
}

event = {
	id = rds_misc.5
	hide_window = yes
	trigger = {
		has_trait = leader_trait_death
	}
	is_triggered_only = yes
	immediate = {
		kill_leader = {
			show_notification = yes
		}
	}
}

#TECH_COPYER
country_event = {
	id = rds_misc.6
	hide_window = yes
	trigger = {
	}
	is_triggered_only = yes
	immediate = {
		random_country = {
			limit = {
				is_country_type = fallen_empire
			}
			save_event_target_as = target_to_copy_tech
		}
		copy_techs_from = {
			target = event_target:target_to_copy_tech
		}
	}
}

#SYSTEM_DESTROYER
event = {
	id = rds_misc.7
	title = rds_misc.7.name
	desc = rds_misc.7.desc
	hide_window = no
	trigger = {
		This = {
			is_ship_size = 	quantum_bomb
		}
	}
	is_triggered_only = yes
	immediate = {
	}
	option = {
		name = rds_system_destroyer.neutron_extermination
		trigger = {
		}
		custom_tooltip = rds_system_destroyer.neutron_extermination.tooltip
		hidden_effect = {
			This.solar_system = {
				every_system_colony = {
					limit = {						
					}
					every_owned_pop = {
						limit = {
						}
						kill_pop = yes
					}
				}
			}
		}
	}
	option = {
		name = rds_system_destroyer.planetary_system_silence
		trigger = {
		}
		custom_tooltip = rds_system_destroyer.planetary_system_silence.tooltip
		hidden_effect = {
			This.solar_system = {
				set_asteroid_belt = { radius = 0 }
				every_system_ambient_object = {
					limit = {
					}
					destroy_ambient_object = this
				}
				every_system_megastructure = {
					limit = {
					}
					remove_megastructure = this
				}
				every_system_planet = {
					limit = {
						is_star = no
					}
					remove_planet = yes
				}
				every_fleet_in_system = {
					limit = {
					}
					destroy_fleet = this
				}
			}
		}
	}
	option = {
		name = rds_system_destroyer.gui_close
		trigger = {
		}
		custom_tooltip = rds_system_destroyer.gui_close.tooltip
	}
}

#POP_REBIRTHER
event = {
	id = rds_misc.8
	hide_window = yes
	trigger = {
		always = no
	}
	is_triggered_only = yes
	immediate = {
		create_pop = {
			species = This
			ethos = This
		}
	}
}

#ANTI_PLANET_BOMBARDED
event = {
	id = rds_misc.9
	hide_window = yes
	trigger = {
		has_active_building = building_rds_planetary_shield_generator
	}
	is_triggered_only = yes
	immediate = {
		This = {
			add_planet_devastation = value:dynamic_planet_devastation
		}
	}
}

#INFINTE_ASCENSION_PERKS_SLOTS
event = {
	id = rds_misc.10
	hide_window = yes
	trigger = {
		This = {
			NOT = {
				num_ascension_perks < trigger:num_ascension_perk_slots	
			}
		}
	}
	is_triggered_only = yes
	immediate = {
		add_modifier = {	modifier = swn_mod_ascension_perks_add	}
	}
}

#RDS_BUILDING
event = {
	id = rds_misc.11
	hide_window = yes
	trigger = {
	}
	is_triggered_only = yes
	immediate = {
		set_variable = { which = dynamic_housing_number value = value:dynamic_housing }
		set_variable = { which = dynamic_country_resource_max_add_number value = value:dynamic_country_resource_max_add }
	}
}

event = {
	id = rds_misc.12
	hide_window = yes
	trigger = {
	}
	is_triggered_only = yes
	immediate = {
		FROM = {
			set_variable = { which = dynamic_housing_number value = value:dynamic_housing }
		}
	}
}

#Leader_RDS
event = {
	id = rds_misc.13
	hide_window = yes
	trigger = {
		has_technology = tech_reality_distortion_system
		from = {
			leader_class = admiral
		}
	}
	is_triggered_only = yes
	immediate = {
		from = {
			add_trait = leader_trait_rds
		}
	}
}

#Bypass
fleet_event = {
	id = rds_misc.14
	is_triggered_only = yes
	hide_window = yes
	immediate = {
		if = {
			limit = {
				fromfrom = {
					solar_system = {
						any_system_megastructure = {
							is_megastructure_type = quantum_catapult_rds
						}
					}
					owner = {
						has_technology = tech_mega_engineering
						NOT = {
							has_country_flag = yeeted_a_fleet_rds
						}
					}
				}
			}
			this = {
				owner = {
					set_country_flag = yeeted_a_fleet_rds
				}
			}
			create_rds_wormhole_link = yes
		}
	}
}